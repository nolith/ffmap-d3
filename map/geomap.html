<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" href="leaflet.css" type="text/css" />
    <link href='style.css' rel='stylesheet' type='text/css' />
    <link href='geomap.css' rel='stylesheet' type='text/css' />

    <style type="text/css">
      #map {
        width: 100%;
        box-sizing:border-box;
      }
      .olPopup p { margin:0px; }
      .nodePopup { font-size: 0.8em; }
      .nodePopup .label { font-weight: bold; }
    </style>

    <title>Ninux Firenze - Mappa dei nodi</title>

    <script type="text/javascript" src="lib/d3.min.js"></script>
    <script type="text/javascript" src="leaflet.js"></script>
    <script type="text/javascript" src="links.js"></script>
    <script type="text/javascript" src="loader.js"></script>
    <script type="text/javascript" src="geomap.js"></script>

    <script type="text/javascript">
      var nodes_json = "../_list/network/network?start_key=[\"firenze\"]&end_node=[\"firenze\",{}]"

      window.onresize = resize

      function getOffset( el ) {
        var _x = 0, _y = 0

        while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {
          _x += el.offsetLeft - el.scrollLeft
          _y += el.offsetTop - el.scrollTop
          el = el.offsetParent
        }
        return { top: _y, left: _x }
      }

      function resize() {
        var offset = getOffset(document.getElementById('map'))

        var w = window.innerWidth - offset.left
        var h = window.innerHeight - offset.top - 1

        d3.select("#map").style("width", w+"px").style("height", h+"px")
      }
    </script>
  </head>

  <body onload="resize(); init()">
    <header>
      <h1>firenze.ninux.org</h1>
      <ul>
        <li><a href="nodes.html">Grafo rete</a></li>
        <li><a href="geomap.html">Mappa nodi</a></li>
      </ul>
      <button id="gpsbutton">Ottieni coordinate con un click su mappa</button>
    </header>
    <div id="map"></div>
  </body>
</html>
